
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3D Wallet + Expense Tracker</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* ===========================
       YOUR THEME CSS (as provided)
       =========================== */
:root {
    /* Light Theme Colors */
    --bg-primary: #f5f7fa;
    --bg-secondary: #ffffff;
    --bg-card: #ffffff;
    --text-primary: #1a202c;
    --text-secondary: #4a5568;
    --text-muted: #718096;
    --border-color: #e2e8f0;
    --shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
    
    /* Brand Colors */
    --color-primary: #10b981;
    --color-primary-dark: #059669;
    --color-danger: #ef4444;
    --color-danger-dark: #dc2626;
    --color-warning: #f59e0b;
    --color-info: #3b82f6;
    
    /* Category Colors */
    --food-color: #f59e0b;
    --transport-color: #3b82f6;
    --bills-color: #8b5cf6;
    --entertainment-color: #ec4899;
    --shopping-color: #14b8a6;
    --health-color: #ef4444;
    --education-color: #6366f1;
    --other-color: #64748b;
}

[data-theme="dark"] {
    --bg-primary: #0f172a;
    --bg-secondary: #1e293b;
    --bg-card: #1e293b;
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;
    --text-muted: #94a3b8;
    --border-color: #334155;
    --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    min-height: 100vh;
    transition: background 0.3s ease, color 0.3s ease;
}

/* ===========================
   CONTAINER & LAYOUT
   =========================== */
.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem 1rem;
}

.main-grid {
    display: grid;
    grid-template-columns: 1fr 1.5fr;
    gap: 2rem;
    margin-top: 2rem;
}

/* ===========================
   HEADER
   =========================== */
.header {
    background: var(--bg-card);
    padding: 1.5rem 2rem;
    border-radius: 1rem;
    box-shadow: var(--shadow);
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.header-icon {
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    color: white;
    width: 60px;
    height: 60px;
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.header h1 {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.subtitle {
    font-size: 0.9rem;
    color: var(--text-muted);
}

/* Theme Toggle */
.theme-toggle {
    background: var(--bg-primary);
    border: 2px solid var(--border-color);
    color: var(--text-primary);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.theme-toggle:hover {
    transform: scale(1.05);
    border-color: var(--color-primary);
}

/* ===========================
   SUMMARY CARDS
   =========================== */
.summary-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
}

.summary-card {
    background: var(--bg-card);
    padding: 1.5rem;
    border-radius: 1rem;
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    gap: 1rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.summary-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
}

.summary-icon {
    width: 60px;
    height: 60px;
    border-radius: 0.75rem;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.card-total .summary-icon {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
}

.card-count .summary-icon {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
}

.card-month .summary-icon {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    color: white;
}

.summary-label {
    font-size: 0.85rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
}

.summary-value {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text-primary);
}

/* ===========================
   CARDS
   =========================== */
.card {
    background: var(--bg-card);
    border-radius: 1rem;
    padding: 1.75rem;
    box-shadow: var(--shadow);
    margin-bottom: 1.5rem;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.card-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 1.5rem;
}

/* ===========================
   FORM STYLES
   =========================== */
.form-group {
    margin-bottom: 1.25rem;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-secondary);
}

.required {
    color: var(--color-danger);
}

input,
select,
textarea {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--border-color);
    border-radius: 0.5rem;
    font-size: 0.95rem;
    font-family: inherit;
    background: var(--bg-card);
    color: var(--text-primary);
    transition: all 0.2s ease;
}

input:focus,
select:focus,
textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
}

input.error,
select.error,
textarea.error {
    border-color: var(--color-danger);
}

textarea {
    resize: vertical;
}

.error-message {
    display: block;
    margin-top: 0.35rem;
    font-size: 0.8rem;
    color: var(--color-danger);
    min-height: 1rem;
}

/* ===========================
   BUTTONS
   =========================== */
.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 0.5rem;
    font-size: 0.95rem;
    font-weight: 500;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s ease;
    font-family: inherit;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-primary {
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    color: white;
}

.btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.btn-secondary {
    background: var(--bg-primary);
    color: var(--text-primary);
    border: 2px solid var(--border-color);
}

.btn-secondary:hover:not(:disabled) {
    background: var(--border-color);
}

.btn-danger {
    background: var(--color-danger);
    color: white;
}

.btn-danger:hover:not(:disabled) {
    background: var(--color-danger-dark);
    transform: translateY(-2px);
}

.btn-sm {
    padding: 0.5rem 1rem;
    font-size: 0.85rem;
}

.btn-icon {
    padding: 0.5rem;
    border-radius: 0.375rem;
    background: transparent;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-icon.edit {
    color: var(--color-info);
}

.btn-icon.edit:hover {
    background: rgba(59, 130, 246, 0.1);
}

.btn-icon.delete {
    color: var(--color-danger);
}

.btn-icon.delete:hover {
    background: rgba(239, 68, 68, 0.1);
}

.form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 1.5rem;
}

.form-actions .btn {
    flex: 1;
}

/* ===========================
   SEARCH & FILTER
   =========================== */
.search-filter {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.search-box {
    position: relative;
    flex: 1;
}

.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-muted);
    pointer-events: none;
}

.search-box input {
    padding-left: 3rem;
}

.filter-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.filter-select {
    padding: 0.65rem 1rem;
    font-size: 0.9rem;
}

/* ===========================
   TABLE
   =========================== */
.table-wrapper {
    overflow-x: auto;
    border-radius: 0.75rem;
    border: 2px solid var(--border-color);
}

.expense-table {
    width: 100%;
    border-collapse: collapse;
}

.expense-table thead {
    background: var(--bg-primary);
}

.expense-table th {
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 2px solid var(--border-color);
}

.expense-table td {
    padding: 1rem;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-primary);
}

.expense-table tbody tr {
    transition: background 0.2s ease;
}

.expense-table tbody tr:hover {
    background: var(--bg-primary);
}

.expense-table tbody tr:last-child td {
    border-bottom: none;
}

.text-center {
    text-align: center;
}

/* Category Badge */
.category-badge {
    display: inline-block;
    padding: 0.35rem 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.8rem;
    font-weight: 500;
}

.category-Food { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
.category-Transport { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
.category-Bills { background: rgba(139, 92, 246, 0.15); color: #8b5cf6; }
.category-Entertainment { background: rgba(236, 72, 153, 0.15); color: #ec4899; }
.category-Shopping { background: rgba(20, 184, 166, 0.15); color: #14b8a6; }
.category-Health { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
.category-Education { background: rgba(99, 102, 241, 0.15); color: #6366f1; }
.category-Other { background: rgba(100, 116, 139, 0.15); color: #64748b; }

/* Amount */
.amount {
    font-weight: 600;
    font-size: 1.05rem;
    color: var(--color-danger);
}

/* Actions */
.action-buttons {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
}

/* ===========================
   EMPTY STATE
   =========================== */
.empty-state {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem 1rem;
    text-align: center;
}

.empty-state.active {
    display: flex;
}

.empty-state svg {
    color: var(--text-muted);
    margin-bottom: 1rem;
    opacity: 0.5;
}

.empty-state h3 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.empty-state p {
    color: var(--text-muted);
}

/* ===========================
   MODAL
   =========================== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--bg-card);
    border-radius: 1rem;
    width: 100%;
    max-width: 450px;
    box-shadow: var(--shadow-lg);
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 2px solid var(--border-color);
}

.modal-header h2 {
    font-size: 1.25rem;
    color: var(--text-primary);
}

.modal-close {
    background: transparent;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: all 0.2s ease;
}

.modal-close:hover {
    background: var(--bg-primary);
    color: var(--text-primary);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    display: flex;
    gap: 1rem;
    padding: 1.5rem;
    border-top: 2px solid var(--border-color);
}

.modal-footer .btn {
    flex: 1;
}

/* ===========================
   CHART
   =========================== */
.chart-card {
    margin-top: 1.5rem;
}

.chart-container {
    position: relative;
    height: 300px;
}

/* ===========================
   TOAST NOTIFICATIONS
   =========================== */
#toast-container {
    position: fixed;
    top: 2rem;
    right: 2rem;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.toast {
    background: var(--bg-card);
    border-left: 4px solid;
    border-radius: 0.5rem;
    padding: 1rem 1.25rem;
    box-shadow: var(--shadow-lg);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    min-width: 300px;
    animation: toastSlideIn 0.3s ease-out;
}

@keyframes toastSlideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.toast.success {
    border-left-color: var(--color-primary);
}

.toast.error {
    border-left-color: var(--color-danger);
}

.toast.warning {
    border-left-color: var(--color-warning);
}

.toast-icon {
    flex-shrink: 0;
}

.toast.success .toast-icon {
    color: var(--color-primary);
}

.toast.error .toast-icon {
    color: var(--color-danger);
}

.toast.warning .toast-icon {
    color: var(--color-warning);
}

.toast-message {
    flex: 1;
    color: var(--text-primary);
    font-size: 0.9rem;
}

/* ===========================
   FOOTER
   =========================== */
.footer {
    text-align: center;
    padding: 2rem 1rem;
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-top: 3rem;
}

/* ===========================
   RESPONSIVE DESIGN
   =========================== */
@media (max-width: 1024px) {
    .main-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
    }

    .header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }

    .header h1 {
        font-size: 1.5rem;
    }

    .summary-cards {
        grid-template-columns: 1fr;
    }

    .form-row {
        grid-template-columns: 1fr;
    }

    .filter-group {
        grid-template-columns: 1fr;
    }

    .expense-table {
        font-size: 0.85rem;
    }

    .expense-table th,
    .expense-table td {
        padding: 0.75rem 0.5rem;
    }

    #toast-container {
        top: 1rem;
        right: 1rem;
        left: 1rem;
    }

    .toast {
        min-width: auto;
    }

    .search-filter {
        gap: 0.75rem;
    }
}

@media (max-width: 480px) {
    .header-content {
        flex-direction: column;
    }

    .summary-value {
        font-size: 1.5rem;
    }

    .card {
        padding: 1.25rem;
    }

    .modal-content {
        margin: 0;
        border-radius: 0;
        max-height: 100vh;
    }
}

/* ===========================
   3D HERO + TRANSITION STYLES
   =========================== */
.intro-section {
  position: relative;
  height: 100vh;
  width: 100%;
  background: radial-gradient(circle at center, #0a0a0a, #000);
  overflow: hidden;
  color: white;
}

#three-canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0; /* behind content which has z-index: 2 */
  transition: opacity 0.9s ease, transform 0.9s ease;
}

.intro-text {
  position: absolute;
  top: 48%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
  color: #fff;
  z-index: 1;
}

.scroll-indicator {
  position: absolute;
  bottom: 36px;
  left: 50%;
  transform: translateX(-50%) rotate(-45deg);
  width: 30px;
  height: 30px;
  border-left: 3px solid white;
  border-bottom: 3px solid white;
  animation: bounce 1.5s infinite;
  z-index: 1;
}

.main-section {
  position: relative;
  background: var(--bg-primary);
  min-height: 100vh;
  padding: 24px 0 80px;
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.9s ease, transform 0.9s ease;
  z-index: 2;
}

.main-section.visible {
  opacity: 1;
  transform: translateY(0);
}

/* ensure top spacing after hero */
.main-section .container {
  margin-top: 24px;
}

/* small improvement for visibility when 3D fades */
.intro-faded {
  pointer-events: none;
  opacity: 0;
  transform: scale(1.02);
}
  </style>
</head>
<body>

  <!-- HERO: 3D wallet -->
  <section class="intro-section" id="intro">
    <canvas id="three-canvas" aria-hidden="true"></canvas>
    <div class="intro-text">
      <h1 style="font-size:28px; margin-bottom:8px;">Welcome ‚Äî scroll to enter your Expense Tracker ü™ô</h1>
      <p style="color:var(--text-muted); margin:0;">Wallet rotates while you scroll. Keep going to open the app.</p>
    </div>
    <div class="scroll-indicator" aria-hidden="true"></div>
  </section>

  <!-- MAIN: Expense Tracker (full real app) -->
  <section class="main-section" id="main-content" aria-live="polite">
    <div class="container">
      <!-- Toast -->
      <div id="toast-container" aria-hidden="true"></div>

      <!-- Header -->
      <div class="header">
        <div class="header-content">
          <div class="header-icon" aria-hidden="true">
            <!-- simple wallet icon -->
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="5" width="20" height="14" rx="2" />
              <path d="M16 11a1 1 0 0 1 1 1" />
            </svg>
          </div>
          <div>
            <h1>Expense Tracker</h1>
            <p class="subtitle">Manage your monthly spending</p>
          </div>
        </div>

        <div style="display:flex;align-items:center;gap:12px;">
          <button class="btn btn-secondary btn-sm" id="clear-all-btn" title="Clear all expenses" style="display:none;">Clear All</button>
          <button class="theme-toggle" id="theme-toggle" title="Toggle theme">üåó</button>
        </div>
      </div>

      <!-- Summary -->
      <div class="summary-cards" aria-hidden="false">
        <div class="summary-card card-total">
          <div class="summary-icon" aria-hidden="true">
            <!-- icon -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6">
              <rect x="1" y="4" width="22" height="16" rx="2"></rect>
            </svg>
          </div>
          <div>
            <p class="summary-label">Total Expenses</p>
            <p class="summary-value" id="total-expenses">$0.00</p>
          </div>
        </div>

        <div class="summary-card card-count">
          <div class="summary-icon" aria-hidden="true">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg>
          </div>
          <div>
            <p class="summary-label">Transactions</p>
            <p class="summary-value" id="total-count">0</p>
          </div>
        </div>

        <div class="summary-card card-month">
          <div class="summary-icon" aria-hidden="true">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><rect x="3" y="4" width="18" height="18" rx="2"/></svg>
          </div>
          <div>
            <p class="summary-label">This Month</p>
            <p class="summary-value" id="month-expenses">$0.00</p>
          </div>
        </div>
      </div>

      <!-- Grid: Form + List -->
      <div class="main-grid">
        <!-- Form -->
        <div class="form-section">
          <div class="card">
            <h2 class="card-title">Add New Expense</h2>
            <form id="expense-form" autocomplete="off">
              <div class="form-group">
                <label for="expense-name">Expense Name <span class="required">*</span></label>
                <input id="expense-name" required type="text" placeholder="e.g., Grocery Shopping" />
                <span class="error-message" id="name-error"></span>
              </div>

              <div class="form-group">
                <label for="expense-category">Category <span class="required">*</span></label>
                <select id="expense-category" required>
                  <option value="">Select Category</option>
                  <option value="Food">Food</option>
                  <option value="Transport">Transport</option>
                  <option value="Bills">Bills</option>
                  <option value="Entertainment">Entertainment</option>
                  <option value="Shopping">Shopping</option>
                  <option value="Health">Health</option>
                  <option value="Education">Education</option>
                  <option value="Other">Other</option>
                </select>
                <span class="error-message" id="category-error"></span>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="expense-amount">Amount ($) <span class="required">*</span></label>
                  <input id="expense-amount" required type="number" step="0.01" min="0" placeholder="0.00" />
                  <span class="error-message" id="amount-error"></span>
                </div>
                <div class="form-group">
                  <label for="expense-date">Date <span class="required">*</span></label>
                  <input id="expense-date" required type="date" />
                  <span class="error-message" id="date-error"></span>
                </div>
              </div>

              <div class="form-group">
                <label for="expense-description">Description (Optional)</label>
                <textarea id="expense-description" rows="3" placeholder="Add notes..."></textarea>
              </div>

              <div class="form-actions">
                <button type="button" id="cancel-edit" class="btn btn-secondary" style="display:none;">Cancel</button>
                <button type="submit" id="submit-btn" class="btn btn-primary">Add Expense</button>
              </div>
            </form>
          </div>

          <!-- Chart -->
          <div class="card chart-card">
            <h3 class="card-title">Spending by Category</h3>
            <div class="chart-container">
              <canvas id="category-chart"></canvas>
            </div>
          </div>
        </div>

        <!-- List -->
        <div class="list-section">
          <div class="card">
            <div class="card-header">
              <h2 class="card-title">Expense List</h2>
              <button id="export-btn" class="btn btn-secondary btn-sm">Export JSON</button>
            </div>

            <div class="search-filter">
              <div class="search-box">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>
                <input id="search-input" placeholder="Search expenses..." />
              </div>

              <div class="filter-group">
                <select id="filter-category" class="filter-select">
                  <option value="">All Categories</option>
                  <option value="Food">Food</option>
                  <option value="Transport">Transport</option>
                  <option value="Bills">Bills</option>
                  <option value="Entertainment">Entertainment</option>
                  <option value="Shopping">Shopping</option>
                  <option value="Health">Health</option>
                  <option value="Education">Education</option>
                  <option value="Other">Other</option>
                </select>

                <select id="sort-by" class="filter-select">
                  <option value="date-desc">Newest First</option>
                  <option value="date-asc">Oldest First</option>
                  <option value="amount-desc">Highest Amount</option>
                  <option value="amount-asc">Lowest Amount</option>
                </select>
              </div>
            </div>

            <div class="table-wrapper" style="margin-top:1rem;">
              <table class="expense-table" id="expense-table" role="table" aria-label="Expenses">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Amount</th>
                    <th class="text-center">Actions</th>
                  </tr>
                </thead>
                <tbody id="expense-table-body"></tbody>
              </table>

              <div class="empty-state" id="empty-state">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="4" width="22" height="16" rx="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                <h3>No Expenses Yet</h3>
                <p id="empty-state-text">Start tracking by adding your first expense!</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Delete Modal -->
      <div class="modal" id="delete-modal" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Delete Expense</h2>
            <button class="modal-close" id="modal-close">&times;</button>
          </div>
          <div class="modal-body">
            <p id="delete-message">Are you sure you want to delete this expense?</p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" id="cancel-delete-btn">Cancel</button>
            <button class="btn btn-danger" id="confirm-delete-btn">Delete</button>
          </div>
        </div>
      </div>

      <footer class="footer" style="margin-top:28px;">
        Expense Tracker ¬© 2025 | Local storage
      </footer>
    </div>
  </section>

  <!-- THREE.JS (r146) -->
  <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r146/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r146/examples/js/loaders/GLTFLoader.js"></script>

  <script>
/* ========= 3D HERO (full-screen hero that fades on scroll) ========= */
(function () {
  const canvas = document.getElementById('three-canvas');
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera( 55, window.innerWidth / window.innerHeight, 0.1, 1000 );
  camera.position.z = 3;
  const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
  renderer.setPixelRatio(window.devicePixelRatio || 1);
  renderer.setSize(window.innerWidth, window.innerHeight);

  // Lights
  const d = new THREE.DirectionalLight(0xffffff, 1.2);
  d.position.set(5,5,5);
  scene.add(d);
  scene.add(new THREE.AmbientLight(0xffffff, 0.6));

  let model = null;
  const loader = new THREE.GLTFLoader();

  // Friendly fallback model: Wallet glTF from Khronos sample models
  loader.load(
    'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Wallet/glTF/Wallet.gltf',
    gltf => {
      model = gltf.scene;
      model.scale.set(2.2,2.2,2.2);
      // center model a bit and rotate for better initial stance
      model.rotation.y = Math.PI * 0.05;
      model.position.y = -0.25;
      scene.add(model);
    },
    undefined,
    err => {
      console.error('3D model load error:', err);
    }
  );

  function onResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }
  window.addEventListener('resize', onResize);

  function animate() {
    requestAnimationFrame(animate);
    if (model) {
      const s = window.scrollY || document.documentElement.scrollTop;
      // small, stable mapping: scroll in pixels -> rotation
      const rotation = s * 0.002; // small factor
      model.rotation.y = rotation;
      model.rotation.x = Math.sin(rotation * 0.35) * 0.08;
    }
    renderer.render(scene, camera);
  }
  animate();
})();

/* ========= SCROLL FADE LOGIC ========= */
(function () {
  const canvas = document.getElementById('three-canvas');
  const main = document.getElementById('main-content');
  const intro = document.getElementById('intro');

  function updateOnScroll() {
    const scrollY = window.scrollY || document.documentElement.scrollTop;
    const vh = window.innerHeight || document.documentElement.clientHeight;
    const trigger = vh * 0.45;

    if (scrollY > trigger) {
      // fade the intro (canvas + intro text) and reveal main
      intro.classList.add('intro-faded');
      main.classList.add('visible');
    } else {
      intro.classList.remove('intro-faded');
      main.classList.remove('visible');
    }
  }

  // initialize visibility if page loaded in scrolled position
  window.addEventListener('scroll', updateOnScroll, { passive: true });
  window.addEventListener('resize', updateOnScroll);
  document.addEventListener('DOMContentLoaded', updateOnScroll);
})();

/* ========= EXPENSE TRACKER LOGIC ========= */
(function () {
  // Utilities
  const $ = (id) => document.getElementById(id);
  const formatCurrency = (n) => {
    // ensure two decimal places
    const v = Number(n);
    if (Number.isNaN(v)) return '$0.00';
    // Use locale formatting
    return v.toLocaleString(undefined, { style: 'currency', currency: 'USD', minimumFractionDigits: 2 });
  };

  // State & storage
  const STORAGE_KEY = 'exp_tracker_v1';
  let expenses = []; // {id, name, category, amount, date, desc}
  let editId = null;

  // Elements
  const form = $('expense-form');
  const nameI = $('expense-name');
  const catI = $('expense-category');
  const amtI = $('expense-amount');
  const dateI = $('expense-date');
  const descI = $('expense-description');
  const tableBody = $('expense-table-body');
  const totalExpensesEl = $('total-expenses');
  const totalCountEl = $('total-count');
  const monthExpensesEl = $('month-expenses');
  const emptyState = $('empty-state');
  const cancelEditBtn = $('cancel-edit');
  const clearAllBtn = $('clear-all-btn');
  const searchInput = $('search-input');
  const filterCategory = $('filter-category');
  const sortBy = $('sort-by');
  const exportBtn = $('export-btn');

  // Chart
  const chartCtx = document.getElementById('category-chart').getContext('2d');
  let pieChart = null;

  // Load
  function load() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      expenses = raw ? JSON.parse(raw) : [];
    } catch (e) {
      expenses = [];
    }
  }
  function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(expenses));
  }

  // Render
  function renderTable() {
    // apply search, filter, sort
    const q = (searchInput.value || '').trim().toLowerCase();
    const cat = filterCategory.value;
    const sorted = [...expenses].filter(item => {
      if (q) {
        const hay = `${item.name} ${item.category} ${item.desc}`.toLowerCase();
        if (!hay.includes(q)) return false;
      }
      if (cat && item.category !== cat) return false;
      return true;
    });

    // sort
    switch (sortBy.value) {
      case 'date-asc': sorted.sort((a,b)=> new Date(a.date) - new Date(b.date)); break;
      case 'date-desc': sorted.sort((a,b)=> new Date(b.date) - new Date(a.date)); break;
      case 'amount-asc': sorted.sort((a,b)=> Number(a.amount) - Number(b.amount)); break;
      case 'amount-desc': sorted.sort((a,b)=> Number(b.amount) - Number(a.amount)); break;
    }

    // build rows
    tableBody.innerHTML = '';
    if (sorted.length === 0) {
      emptyState.classList.add('active');
    } else {
      emptyState.classList.remove('active');
      for (const e of sorted) {
        const tr = document.createElement('tr');

        const tdDate = document.createElement('td');
        tdDate.textContent = new Date(e.date).toLocaleDateString();
        tr.appendChild(tdDate);

        const tdName = document.createElement('td');
        tdName.textContent = e.name;
        tr.appendChild(tdName);

        const tdCat = document.createElement('td');
        const span = document.createElement('span');
        span.className = `category-badge category-${e.category.replace(/\s+/g,'')}`;
        span.textContent = e.category;
        tdCat.appendChild(span);
        tr.appendChild(tdCat);

        const tdAmt = document.createElement('td');
        tdAmt.textContent = formatCurrency(e.amount);
        tdAmt.className = 'amount';
        tr.appendChild(tdAmt);

        const tdAct = document.createElement('td');
        tdAct.className = 'text-center';
        tdAct.innerHTML = `
          <button class="btn-icon edit" title="Edit" data-id="${e.id}">‚úèÔ∏è</button>
          <button class="btn-icon delete" title="Delete" data-id="${e.id}">üóëÔ∏è</button>
        `;
        tr.appendChild(tdAct);

        tableBody.appendChild(tr);
      }
    }

    updateSummary();
    updateChart();
    bindRowActions();
  }

  // Summary
  function updateSummary() {
    const total = expenses.reduce((acc, it) => acc + Number(it.amount || 0), 0);
    totalExpensesEl.textContent = formatCurrency(total);

    totalCountEl.textContent = expenses.length;

    // this month
    const now = new Date();
    const thisMonthTotal = expenses.reduce((acc,it) => {
      const d = new Date(it.date);
      if (d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear()) {
        return acc + Number(it.amount || 0);
      }
      return acc;
    }, 0);
    monthExpensesEl.textContent = formatCurrency(thisMonthTotal);

    // show/hide clearAll button
    clearAllBtn.style.display = expenses.length ? 'inline-flex' : 'none';
  }

  // Chart: spending by category
  function updateChart() {
    const byCat = expenses.reduce((acc,it) => {
      acc[it.category] = (acc[it.category] || 0) + Number(it.amount || 0);
      return acc;
    }, {});
    const labels = Object.keys(byCat);
    const data = labels.map(l => byCat[l]);

    if (pieChart) pieChart.destroy();
    pieChart = new Chart(chartCtx, {
      type: 'pie',
      data: {
        labels,
        datasets: [{
          data,
          backgroundColor: labels.map(l => {
            switch (l) {
              case 'Food': return 'rgba(245,158,11,0.85)';
              case 'Transport': return 'rgba(59,130,246,0.85)';
              case 'Bills': return 'rgba(139,92,246,0.85)';
              case 'Entertainment': return 'rgba(236,72,153,0.85)';
              case 'Shopping': return 'rgba(20,184,166,0.85)';
              case 'Health': return 'rgba(239,68,68,0.85)';
              case 'Education': return 'rgba(99,102,241,0.85)';
              default: return 'rgba(100,116,139,0.85)';
            }
          })
        }]
      },
      options: {
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });
  }

  // Row actions (edit/delete)
  function bindRowActions() {
    tableBody.querySelectorAll('.btn-icon.edit').forEach(btn => {
      btn.onclick = (ev) => {
        const id = btn.getAttribute('data-id');
        startEdit(id);
      };
    });
    tableBody.querySelectorAll('.btn-icon.delete').forEach(btn => {
      btn.onclick = (ev) => {
        const id = btn.getAttribute('data-id');
        confirmDelete(id);
      };
    });
  }

  // Create/Update
  function addExpense(payload) {
    payload.id = String(Date.now()) + Math.random().toString(36).slice(2,6);
    expenses.push(payload);
    save();
    renderTable();
    showToast('Expense added', 'success');
  }
  function updateExpense(id, payload) {
    const idx = expenses.findIndex(x => x.id === id);
    if (idx >= 0) {
      expenses[idx] = Object.assign({ id }, payload);
      save();
      renderTable();
      showToast('Expense updated', 'success');
    }
  }

  // Edit flow
  function startEdit(id) {
    const it = expenses.find(x => x.id === id);
    if (!it) return;
    editId = id;
    nameI.value = it.name;
    catI.value = it.category;
    amtI.value = it.amount;
    dateI.value = it.date;
    descI.value = it.desc || '';
    $('submit-btn').textContent = 'Save Changes';
    cancelEditBtn.style.display = 'inline-flex';
  }
  cancelEditBtn.addEventListener('click', () => {
    resetForm();
  });

  function resetForm() {
    editId = null;
    form.reset();
    $('submit-btn').textContent = 'Add Expense';
    cancelEditBtn.style.display = 'none';
    clearErrors();
  }

  // Delete flow
  let pendingDeleteId = null;
  const deleteModal = $('delete-modal');
  const confirmDeleteBtn = $('confirm-delete-btn');
  const cancelDeleteBtn = $('cancel-delete-btn');
  const modalCloseBtn = $('modal-close');

  function confirmDelete(id) {
    pendingDeleteId = id;
    deleteModal.classList.add('active');
    deleteModal.setAttribute('aria-hidden','false');
  }
  confirmDeleteBtn.onclick = () => {
    if (!pendingDeleteId) return;
    expenses = expenses.filter(x=> x.id !== pendingDeleteId);
    save();
    renderTable();
    showToast('Expense deleted', 'warning');
    pendingDeleteId = null;
    deleteModal.classList.remove('active');
    deleteModal.setAttribute('aria-hidden','true');
  };
  cancelDeleteBtn.onclick = () => {
    pendingDeleteId = null;
    deleteModal.classList.remove('active');
    deleteModal.setAttribute('aria-hidden','true');
  };
  modalCloseBtn.onclick = cancelDeleteBtn;

  // Clear all
  clearAllBtn.addEventListener('click', () => {
    if (!confirm('Clear all expenses?')) return;
    expenses = [];
    save();
    renderTable();
    showToast('All expenses cleared', 'warning');
  });

  // Export
  exportBtn && exportBtn.addEventListener('click', () => {
    const blob = new Blob([JSON.stringify(expenses, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'expenses.json';
    a.click();
    URL.revokeObjectURL(url);
  });

  // Toast
  function showToast(msg, type='success') {
    const container = $('toast-container');
    const t = document.createElement('div');
    t.className = `toast ${type==='success'?'success':type==='warning'?'warning':'error'}`;
    t.innerHTML = `<div class="toast-icon">‚óè</div><div class="toast-message">${msg}</div>`;
    container.appendChild(t);
    setTimeout(()=> {
      t.style.opacity = '0';
      setTimeout(()=> t.remove(), 400);
    }, 2200);
  }

  // Validation
  function clearErrors() {
    ['name-error','category-error','amount-error','date-error'].forEach(id => $(id).textContent = '');
  }
  function validate() {
    let ok = true;
    clearErrors();
    if (!nameI.value.trim()) { $('name-error').textContent = 'Name required'; ok = false; }
    if (!catI.value) { $('category-error').textContent = 'Category required'; ok = false; }
    if (!amtI.value || Number(amtI.value) <= 0) { $('amount-error').textContent = 'Enter valid amount'; ok = false; }
    if (!dateI.value) { $('date-error').textContent = 'Date required'; ok = false; }
    return ok;
  }

  // Form submit
  form.addEventListener('submit', (ev) => {
    ev.preventDefault();
    if (!validate()) return;
    const payload = {
      name: nameI.value.trim(),
      category: catI.value,
      amount: Number( Number(amtI.value).toFixed(2) ), // ensure fixed decimals
      date: dateI.value,
      desc: descI.value.trim()
    };
    if (editId) {
      updateExpense(editId, payload);
    } else {
      addExpense(payload);
    }
    resetForm();
  });

  // Filters & search handlers
  [searchInput, filterCategory, sortBy].forEach(el => {
    el.addEventListener('input', renderTable);
    el.addEventListener('change', renderTable);
  });

  // theme toggle
  const themeToggle = $('theme-toggle');
  function initTheme() {
    const stored = localStorage.getItem('theme') || 'light';
    if (stored === 'dark') document.documentElement.setAttribute('data-theme','dark');
  }
  initTheme();
  themeToggle.addEventListener('click', () => {
    const cur = document.documentElement.getAttribute('data-theme');
    if (cur === 'dark') {
      document.documentElement.removeAttribute('data-theme');
      localStorage.setItem('theme','light');
    } else {
      document.documentElement.setAttribute('data-theme','dark');
      localStorage.setItem('theme','dark');
    }
  });

  // Simple accessibility: focus the name on show
  document.addEventListener('keydown', (e) => {
    if (e.key === 'n' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
      nameI.focus();
    }
  });

  // init
  load();
  renderTable();

})();
  </script>
</body>
</html>
